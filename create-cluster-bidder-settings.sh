for ZONE in us-east1-b us-east1-c us-east1-d europe-west1-d europe-west1-b asia-east1-c asia-east1-b; do
  gcloud beta compute --project=mainadvbidder instances create redis-bidder-settings-${ZONE} --zone=${ZONE} --machine-type=custom-2-8192 --subnet=default --network-tier=PREMIUM --metadata=startup-script=\#\!\ /bin/bash$'\n'$'\n'\#Install\ docker$'\n'curl\ -fsSL\ get.docker.com\ -o\ get-docker.sh$'\n'sh\ get-docker.sh$'\n'$'\n'\#make\ sure\ git\ is\ installed\ $'\n'apt\ install\ -y\ git\ redis-tools$'\n'$'\n'\#\ https://github.com/doitintl/mainad-dynomite$'\n'$'\n'git\ clone\ https://github.com/doitintl/mainad-dynomite$'\n'cd\ dynomite-docker$'\n'$'\n'\#\ set\ variables\ $'\n'export\ DC=\`curl\ -Ss\ \"http://metadata.google.internal/computeMetadata/v1/instance/zone\"\ -H\ \"Metadata-Flavor:\ Google\"\ \|\ awk\ -F\ \"/\"\ \'\{print\ \$NF\}\'\ \|\ awk\ -F\ \"-\"\ \'\{print\ \$1\}\'\`$'\n'export\ RACK=\`\ curl\ -Ss\ \"http://metadata.google.internal/computeMetadata/v1/instance/zone\"\ -H\ \"Metadata-Flavor:\ Google\"\ \|\ awk\ -F\ \"/\"\ \'\{print\ \$NF\}\'\`$'\n'$'\n'\#\ set\ configuration$'\n'envsubst\ \<configuration-file-template.yaml\ \>\ configuration-file.yaml$'\n'$'\n'\#\ for\ troubleshooting$'\n'cat\ configuration-file.yaml$'\n'$'\n'\#\ run\ dynomite$'\n'docker\ build\ -t\ dyn\ .$'\n'docker\ run\ --name\ dyn\ -d\ --restart=always\ --dns=169.254.169.254\ -p\ 22222:22222\ -p\ 8101:8101\ -p\ 8102:8102\ dyn --maintenance-policy=MIGRATE --service-account=1089562473502-compute@developer.gserviceaccount.com --scopes=https://www.googleapis.com/auth/devstorage.read_only,https://www.googleapis.com/auth/logging.write,https://www.googleapis.com/auth/monitoring.write,https://www.googleapis.com/auth/servicecontrol,https://www.googleapis.com/auth/service.management.readonly,https://www.googleapis.com/auth/trace.append --image=ubuntu-minimal-1804-bionic-v20181005 --image-project=ubuntu-os-cloud --boot-disk-size=15GB --boot-disk-type=pd-ssd --boot-disk-device-name=redis-bidder-settings-${ZONE} --labels=component=redis-bidder-setting
done
